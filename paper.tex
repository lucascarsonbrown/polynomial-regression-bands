\documentclass{article}
\usepackage{graphicx} % Required for inserting images
\usepackage{amsmath}

\title{Polynomial Regression in Trading Systems}
\author{Lucas Brown}
\date{December 2025}

\begin{document}

\maketitle

% INTRO
\section{Introduction}
Polynomial regression offers a natural extension of linear modeling by allowing nonlinear trends to be approximated through higher-order terms while preserving mathematical interpretability. Unlike deep learning or machine learning models, polynomial regression provides explicit functional forms that enable statistical analysis and, more importantly, transparent decision-making for beginners learning algorithmic trading. \par
A recent paper by Gil Cohen, \textit{Polynomial Moving Regression Band Stocks Trading System}, has demonstrated that polynomial moving regression bands, constructed by fitting polynomial curves to historical price data and defining upper and lower confidence bands using standard deviation thresholds, can be used to generate profitable momentum-based trading signals. Motivated by these findings, this project aims to design, implement, and analyze a polynomial regressionâ€“based modeling framework in Python. 



% DEVELOPING REGRESSION MODELS 
\section{Developing Regression Models}



\subsection{General Regression Models in Trading}

Financial price series are inherently nonlinear, exhibiting behaviors such as curvature, acceleration, and  transitions that cannot be adequately captured by linear trend models. While linear regression provides a useful baseline for modeling directional movement, it fails to represent the infinitely complex structural dynamics that characterize real-world markets. As a result, more flexible yet interpretable modeling frameworks are required for effective trend estimation in trading systems.

Polynomial regression does just this by allowing nonlinear trends to be approximated through higher-order terms while retaining a closed-form mathematical structure. Unlike machine learning approaches, polynomial models provide explicit functional representations of price behavior, enabling interpretability, statistical diagnostics, and controlled complexity. These properties make polynomial regression particularly well-suited for systematic trading research, where transparency and reproducibility are essential.

In these applications, polynomial regression is not applied globally across an entire price history but instead within a rolling-window framework. By recalibrating the model over a fixed-length window of recent observations, the estimated trend adapts continuously to local market conditions. This localized fitting allows the model to respond to evolving price dynamics while avoiding the instability associated with fitting high-order polynomials over long horizons.

Deviations between observed prices and the fitted polynomial trend provide a quantitative measure of short-term price dispersion. These deviations can be summarized using standard residual-based measures of variability and used to construct dynamic upper and lower bounds around the estimated trend. When interpreted as regression bands, these bounds serve as statistically meaningful thresholds that distinguish ordinary price fluctuations from significant momentum-driven movements.


\subsection{Developing Functional Models}

\par In developing a functional model for our purpose, the first variable to be determined is \(d\), the degree of the polynomial. Too small of a degree will not showcase the predictive behavior on dynamics like curvature and accelerations, yet too high of a degree will lead to overfitting, where the model will not be able to reproduce the dynamics of the curves and accelerations. The results of Cohen's strategy recommend using a fourth-degree polynomial MRB (Moving Regression Band), which is what I deployed. The second factor which must be determined is the \(k\) value, the bandwidth multiplier. Assuming that the residuals are approximately symmetric, a small \(k\) (e.g. 0.5 - 1.0), leads to a very tight band behavior with frequent band crossings and high sensitivity to noise. This leads to high trading frequency and short holding periods. A large \(k\) results in rare band crossings and very few trades. In our scenario, the most beneficial bandwidth multiplier is a moderate value, 1.5 - 2.0. This leads to a balance between sensitive and robust behavior, and captures statistically meaningful deviations while filtering random noise. 

\subsection{Rolling Polynomial Regression for Trading Systems}

The \textit{rolling window} ensures that the model adapts to local market behavior, allowing the regression curve and its bands to evolve as new data becomes available. Let \(W\) denote the window length. Typical values range from 20 to 60 trading days, as shorter windows may produce unstable fits while much longer windows fail to reflect short-term market regimes. In this project, a 60-day window was selected to balance stability and reactivity.

For each day \(t\), the regression is fit using the previous \(W\) observations. Let the corresponding time index be\[x = 0, 1, 2, \dots, W-1,\] and let \(y_i\) denote the closing price on day \(i\). A polynomial regression of degree \(d\) is expressed as \[\hat{y}_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \cdots + \beta_d x_i^d.\] The coefficients \(\beta_k\) are determined by ordinary least squares. Each coefficient governs a different component of the curve's structure: \(\beta_1\) captures linear trend, \(\beta_2\) introduces curvature, and higher-order terms allow inflection and more nuanced behavioral changes. The choice of \(d\) therefore controls the flexibility of the model. Guided by the findings of Cohen, a fourth-degree model was selected for its superior performance and balanced complexity.

After fitting the polynomial on the rolling window, the predicted value for the current day is given by \[\hat{y}_t = f(x_t),\] where \(x_t = W\), representing the next point beyond the fitted window. The residuals over the window are\[\varepsilon_i = y_i - \hat{y}_i,\] and the residual dispersion is quantified via the root mean squared error:\[\sigma_t = \sqrt{\frac{1}{W} \sum_{i=1}^{W} \varepsilon_i^2}.\]This rolling standard deviation reflects short-term market volatility around the fitted trend.

Upper and lower polynomial regression bands are then constructed as\[\text{Upper}_t = \hat{y}_t + k\sigma_t, \qquad\text{Lower}_t = \hat{y}_t - k\sigma_t,\]where \(k\) is a positive constant controlling the width of the bands. Smaller values of \(k\) produce tight bands that trigger frequent signals but are highly sensitive to noise, while larger values produce wide bands that trigger only under exceptional price movement. Empirical and statistical considerations suggest a moderate choice of \(k \in [1.5, 2.0]\); in this project, \(k = 2\) was adopted consistent with conventional confidence-band theory and the methodology in Cohen's study.

These bands allow the construction of a momentum-based trading strategy. A long position is initiated when the closing price crosses above the upper band,\[\text{price}_t > \text{Upper}_t,\] indicating statistically significant upward momentum. The position is closed when the price falls below the lower band, \[\text{price}_t < \text{Lower}_t,\] signaling trend deterioration. Because both the regression curve and the volatility measure \(\sigma_t\) evolve dynamically, the resulting model adapts naturally to market conditions and provides a flexible framework for evaluating nonlinear trend-following behavior in financial time series.



% ---------------------------------
% Results
\section{Results}

With 84/100 stocks showing profitability, it is true that this method does, in fact, result in profitable trades, but it does not by any means provide outstanding results. Only 2 stocks surpassed the standard investment which was invested and left to hold in 2010. 

Stocks where Polynomial Band Strategy outperformed Simple Investment:
BKR: Strategy $26482.73 vs Simple $26359.27
CTSH: Strategy $29499.92 vs Simple $28896.68
GFS: Strategy $14941.76 vs Simple $11633.95
KHC: Strategy $12173.99 vs Simple $9692.19
QCOM: Strategy $36756.62 vs Simple $34761.16

Unprofitable Stocks:
ABNB
GEHC

% find years with the largest profitability difference, and analyze what they look like, vs what the worst profitability difference looks like. Need to be analyzing what the structure looked like before the trade was made. 



\end{document}
